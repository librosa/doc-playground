<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>librosa.reassigned_spectrogram &mdash; librosa 0.9.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="librosa.cqt" href="librosa.cqt.html" />
    <link rel="prev" title="librosa.istft" href="librosa.istft.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="../index.html">
            <img src="../_static/librosa_logo_text.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.9.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../core.html">Core IO and DSP</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../core.html#audio-loading">Audio loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#time-domain-processing">Time-domain processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#signal-generation">Signal generation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../core.html#spectral-representations">Spectral representations</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="librosa.stft.html">librosa.stft</a></li>
<li class="toctree-l3"><a class="reference internal" href="librosa.istft.html">librosa.istft</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">librosa.reassigned_spectrogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="librosa.cqt.html">librosa.cqt</a></li>
<li class="toctree-l3"><a class="reference internal" href="librosa.icqt.html">librosa.icqt</a></li>
<li class="toctree-l3"><a class="reference internal" href="librosa.hybrid_cqt.html">librosa.hybrid_cqt</a></li>
<li class="toctree-l3"><a class="reference internal" href="librosa.pseudo_cqt.html">librosa.pseudo_cqt</a></li>
<li class="toctree-l3"><a class="reference internal" href="librosa.vqt.html">librosa.vqt</a></li>
<li class="toctree-l3"><a class="reference internal" href="librosa.iirt.html">librosa.iirt</a></li>
<li class="toctree-l3"><a class="reference internal" href="librosa.fmt.html">librosa.fmt</a></li>
<li class="toctree-l3"><a class="reference internal" href="librosa.magphase.html">librosa.magphase</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#phase-recovery">Phase recovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#harmonics">Harmonics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#magnitude-scaling">Magnitude scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#time-unit-conversion">Time unit conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#frequency-unit-conversion">Frequency unit conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#music-notation">Music notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#frequency-range-generation">Frequency range generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#pitch-and-tuning">Pitch and tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../display.html">Display</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feature.html">Feature extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onset.html">Onset detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beat.html">Beat and tempo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../decompose.html">Spectrogram decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../effects.html">Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../segment.html">Temporal segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sequence.html">Sequential modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../util.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../multichannel.html">Multi-channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filters.html">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cache.html">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ioformats.html">Advanced I/O Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recordings.html">Example files</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">librosa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../core.html">Core IO and DSP</a> &raquo;</li>
      <li>librosa.reassigned_spectrogram</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/librosa.reassigned_spectrogram.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             


  <section id="librosa-reassigned-spectrogram">
<h1>librosa.reassigned_spectrogram<a class="headerlink" href="#librosa-reassigned-spectrogram" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="librosa.reassigned_spectrogram">
<span class="sig-prename descclassname"><span class="pre">librosa.</span></span><span class="sig-name descname"><span class="pre">reassigned_spectrogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">22050</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_fft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hann'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reassign_frequencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reassign_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_power</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/librosa/core/spectrum.html#reassigned_spectrogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#librosa.reassigned_spectrogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Time-frequency reassigned spectrogram.</p>
<p>The reassignment vectors are calculated using equations 5.20 and 5.23 in
<a class="footnote-reference brackets" href="#id5" id="id1">1</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t_reassigned</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">S_th</span><span class="o">/</span><span class="n">S_h</span><span class="p">)</span>
<span class="n">omega_reassigned</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">S_dh</span><span class="o">/</span><span class="n">S_h</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">S_h</span></code> is the complex STFT calculated using the original window,
<code class="docutils literal notranslate"><span class="pre">S_dh</span></code> is the complex STFT calculated using the derivative of the original
window, and <code class="docutils literal notranslate"><span class="pre">S_th</span></code> is the complex STFT calculated using the original window
multiplied by the time offset from the window center. See <a class="footnote-reference brackets" href="#id6" id="id2">2</a> for
additional algorithms, and <a class="footnote-reference brackets" href="#id7" id="id3">3</a> and <a class="footnote-reference brackets" href="#id8" id="id4">4</a> for history and discussion of the
method.</p>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Flandrin, P., Auger, F., &amp; Chassande-Mottin, E. (2002).
Time-Frequency reassignment: From principles to algorithms. In
Applications in Time-Frequency Signal Processing (Vol. 10, pp.
179-204). CRC Press.</p>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Fulop, S. A., &amp; Fitz, K. (2006). Algorithms for computing the
time-corrected instantaneous frequency (reassigned) spectrogram, with
applications. The Journal of the Acoustical Society of America, 119(1),
360. doi:10.1121/1.2133000</p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Auger, F., Flandrin, P., Lin, Y.-T., McLaughlin, S., Meignen, S.,
Oberlin, T., &amp; Wu, H.-T. (2013). Time-Frequency Reassignment and
Synchrosqueezing: An Overview. IEEE Signal Processing Magazine, 30(6),
32-41. doi:10.1109/MSP.2013.2265316</p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Hainsworth, S., Macleod, M. (2003). Time-frequency reassignment: a
review and analysis. Tech. Rep. CUED/FINFENG/TR.459, Cambridge
University Engineering Department</p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>y</strong><span class="classifier">np.ndarray [shape=(…, n)], real-valued</span></dt><dd><p>audio time series. Multi-channel is supported.</p>
</dd>
<dt><strong>sr</strong><span class="classifier">number &gt; 0 [scalar]</span></dt><dd><p>sampling rate of <code class="docutils literal notranslate"><span class="pre">y</span></code></p>
</dd>
<dt><strong>S</strong><span class="classifier">np.ndarray [shape=(…, d, t)] or None</span></dt><dd><p>(optional) complex STFT calculated using the other arguments provided
to <code class="docutils literal notranslate"><span class="pre">reassigned_spectrogram</span></code></p>
</dd>
<dt><strong>n_fft</strong><span class="classifier">int &gt; 0 [scalar]</span></dt><dd><p>FFT window size. Defaults to 2048.</p>
</dd>
<dt><strong>hop_length</strong><span class="classifier">int &gt; 0 [scalar]</span></dt><dd><p>hop length, number samples between subsequent frames.
If not supplied, defaults to <code class="docutils literal notranslate"><span class="pre">win_length</span> <span class="pre">//</span> <span class="pre">4</span></code>.</p>
</dd>
<dt><strong>win_length</strong><span class="classifier">int &gt; 0, &lt;= n_fft</span></dt><dd><p>Window length. Defaults to <code class="docutils literal notranslate"><span class="pre">n_fft</span></code>.
See <a class="reference internal" href="librosa.stft.html#librosa.stft" title="librosa.stft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stft</span></code></a> for details.</p>
</dd>
<dt><strong>window</strong><span class="classifier">string, tuple, number, function, or np.ndarray [shape=(n_fft,)]</span></dt><dd><ul class="simple">
<li><p>a window specification (string, tuple, number);
see <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.get_window.html#scipy.signal.get_window" title="(in SciPy v1.8.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.get_window</span></code></a></p></li>
<li><p>a window function, such as <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.windows.hann.html#scipy.signal.windows.hann" title="(in SciPy v1.8.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.windows.hann</span></code></a></p></li>
<li><p>a user-specified window vector of length <code class="docutils literal notranslate"><span class="pre">n_fft</span></code></p></li>
</ul>
<p>See <a class="reference internal" href="librosa.stft.html#librosa.stft" title="librosa.stft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stft</span></code></a> for details.</p>
</dd>
<dt><strong>center</strong><span class="classifier">boolean</span></dt><dd><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), the signal <code class="docutils literal notranslate"><span class="pre">y</span></code> is padded so that frame
<code class="docutils literal notranslate"><span class="pre">S[:,</span> <span class="pre">t]</span></code> is centered at <code class="docutils literal notranslate"><span class="pre">y[t</span> <span class="pre">*</span> <span class="pre">hop_length]</span></code>. See <em class="xref py py-obj">Notes</em> for
recommended usage in this function.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, then <code class="docutils literal notranslate"><span class="pre">S[:,</span> <span class="pre">t]</span></code> begins at <code class="docutils literal notranslate"><span class="pre">y[t</span> <span class="pre">*</span> <span class="pre">hop_length]</span></code>.</p></li>
</ul>
</dd>
<dt><strong>reassign_frequencies</strong><span class="classifier">boolean</span></dt><dd><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), the returned frequencies will be instantaneous
frequency estimates.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the returned frequencies will be a read-only view of the
STFT bin frequencies for all frames.</p></li>
</ul>
</dd>
<dt><strong>reassign_times</strong><span class="classifier">boolean</span></dt><dd><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), the returned times will be corrected
(reassigned) time estimates for each bin.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the returned times will be a read-only view of the STFT
frame times for all bins.</p></li>
</ul>
</dd>
<dt><strong>ref_power</strong><span class="classifier">float &gt;= 0 or callable</span></dt><dd><p>Minimum power threshold for estimating time-frequency reassignments.
Any bin with <code class="docutils literal notranslate"><span class="pre">np.abs(S[f,</span> <span class="pre">t])**2</span> <span class="pre">&lt;</span> <span class="pre">ref_power</span></code> will be returned as
<em class="xref py py-obj">np.nan</em> in both frequency and time, unless <code class="docutils literal notranslate"><span class="pre">fill_nan</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. If 0
is provided, then only bins with zero power will be returned as
<em class="xref py py-obj">np.nan</em> (unless <code class="docutils literal notranslate"><span class="pre">fill_nan=True</span></code>).</p>
</dd>
<dt><strong>fill_nan</strong><span class="classifier">boolean</span></dt><dd><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code> (default), the frequency and time reassignments for bins
below the power threshold provided in <code class="docutils literal notranslate"><span class="pre">ref_power</span></code> will be returned as
<em class="xref py py-obj">np.nan</em>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the frequency and time reassignments for these bins will
be returned as the bin center frequencies and frame times.</p></li>
</ul>
</dd>
<dt><strong>clip</strong><span class="classifier">boolean</span></dt><dd><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), estimated frequencies outside the range
<em class="xref py py-obj">[0, 0.5 * sr]</em> or times outside the range <em class="xref py py-obj">[0, len(y) / sr]</em> will be
clipped to those ranges.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, estimated frequencies and times beyond the bounds of the
spectrogram may be returned.</p></li>
</ul>
</dd>
<dt><strong>dtype</strong><span class="classifier">numeric type</span></dt><dd><p>Complex numeric type for STFT calculation. Default is inferred to match
the precision of the input signal.</p>
</dd>
<dt><strong>pad_mode</strong><span class="classifier">string</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">center=True</span></code>, the padding mode to use at the edges of the signal.
By default, STFT uses zero padding.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>freqs, times, mags</strong><span class="classifier">np.ndarray [shape=(…, 1 + n_fft/2, t), dtype=real]</span></dt><dd><dl class="simple">
<dt>Instantaneous frequencies:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">freqs[...,</span> <span class="pre">f,</span> <span class="pre">t]</span></code> is the frequency for bin <code class="docutils literal notranslate"><span class="pre">f</span></code>, frame <code class="docutils literal notranslate"><span class="pre">t</span></code>.
If <code class="docutils literal notranslate"><span class="pre">reassign_frequencies=False</span></code>, this will instead be a read-only array
of the same shape containing the bin center frequencies for all frames.</p>
</dd>
<dt>Reassigned times:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">times[...,</span> <span class="pre">f,</span> <span class="pre">t]</span></code> is the time for bin <code class="docutils literal notranslate"><span class="pre">f</span></code>, frame <code class="docutils literal notranslate"><span class="pre">t</span></code>.
If <code class="docutils literal notranslate"><span class="pre">reassign_times=False</span></code>, this will instead be a read-only array of
the same shape containing the frame times for all bins.</p>
</dd>
<dt>Magnitudes from short-time Fourier transform:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">mags[...,</span> <span class="pre">f,</span> <span class="pre">t]</span></code> is the magnitude for bin <code class="docutils literal notranslate"><span class="pre">f</span></code>, frame <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-odd">Warns</dt>
<dd class="field-odd"><dl class="simple">
<dt>RuntimeWarning</dt><dd><p>Frequency or time estimates with zero support will produce a
divide-by-zero warning, and will be returned as <em class="xref py py-obj">np.nan</em> unless
<code class="docutils literal notranslate"><span class="pre">fill_nan=True</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="librosa.stft.html#librosa.stft" title="librosa.stft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stft</span></code></a></dt><dd><p>Short-time Fourier Transform</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>It is recommended to use <code class="docutils literal notranslate"><span class="pre">center=False</span></code> with this function rather than the
librosa default <code class="docutils literal notranslate"><span class="pre">True</span></code>. Unlike <code class="docutils literal notranslate"><span class="pre">stft</span></code>, reassigned times are not aligned to
the left or center of each frame, so padding the signal does not affect the
meaning of the reassigned times. However, reassignment assumes that the
energy in each FFT bin is associated with exactly one signal component and
impulse event.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">reassign_times</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the frame times that are returned will be
aligned to the left or center of the frame, depending on the value of
<code class="docutils literal notranslate"><span class="pre">center</span></code>. In this case, if <code class="docutils literal notranslate"><span class="pre">center</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then <code class="docutils literal notranslate"><span class="pre">pad_mode=&quot;wrap&quot;</span></code> is
recommended for valid estimation of the instantaneous frequencies in the
boundary frames.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amin</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_fft</span> <span class="o">=</span> <span class="mi">64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="mf">1e-3</span> <span class="o">*</span> <span class="n">librosa</span><span class="o">.</span><span class="n">clicks</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">],</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">click_duration</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">click_freq</span><span class="o">=</span><span class="mf">1200.0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span> <span class="o">+</span>\
<span class="gp">... </span>    <span class="mf">1e-3</span> <span class="o">*</span> <span class="n">librosa</span><span class="o">.</span><span class="n">clicks</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">],</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">click_duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">click_freq</span><span class="o">=</span><span class="mf">400.0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span> <span class="o">+</span>\
<span class="gp">... </span>    <span class="mf">1e-3</span> <span class="o">*</span> <span class="n">librosa</span><span class="o">.</span><span class="n">chirp</span><span class="p">(</span><span class="n">fmin</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">1600</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">+</span>\
<span class="gp">... </span>    <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freqs</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">mags</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">reassigned_spectrogram</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span>
<span class="gp">... </span>                                                    <span class="n">n_fft</span><span class="o">=</span><span class="n">n_fft</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mags_db</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">amplitude_to_db</span><span class="p">(</span><span class="n">mags</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">specshow</span><span class="p">(</span><span class="n">mags_db</span><span class="p">,</span> <span class="n">x_axis</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">y_axis</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">hop_length</span><span class="o">=</span><span class="n">n_fft</span><span class="o">//</span><span class="mi">4</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Spectrogram&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label_outer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">mags_db</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Reassigned spectrogram&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%+2.f dB&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/librosa-reassigned_spectrogram-1.png" class="plot-directive" src="../_images/librosa-reassigned_spectrogram-1.png" />
</figure>
</dd></dl>

</section>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="librosa.istft.html" class="btn btn-neutral float-left" title="librosa.istft" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="librosa.cqt.html" class="btn btn-neutral float-right" title="librosa.cqt" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013--2022, librosa development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  

<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: 0.9.1
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Releases</dt>
      <dd><a href="../../0.9.0/index.html">0.9.0</a></dd>
      <dd><a href="librosa.reassigned_spectrogram.html">0.9.1</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-171031946-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-171031946-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>